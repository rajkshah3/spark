Python 3.6.6+ (default, Aug 30 2018, 09:41:10) 
[GCC 8.0.1 20180414 (experimental) [trunk revision 259383]] on linux
Type "help", "copyright", "credits" or "license" for more information.
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[Stage 0:>                                                          (0 + 1) / 1]                                                                                [Stage 65:>                                                         (0 + 4) / 6][Stage 65:>                                                         (0 + 5) / 6][Stage 65:======================================>                   (4 + 2) / 6][Stage 65:================================================>         (5 + 1) / 6]                                                                                [Stage 151:===================>                                     (2 + 4) / 6][Stage 151:===============================================>         (5 + 1) / 6]                                                                                [Stage 253:======================================>                  (4 + 2) / 6]                                                                                [Stage 371:======================================>                  (4 + 2) / 6]                                                                                [Stage 505:======================================>                  (4 + 2) / 6]                                                                                [Stage 655:===============================================>         (5 + 1) / 6]                                                                                [Stage 737:======================================>                  (4 + 2) / 6]                                                                                [Stage 823:======================================>                  (4 + 2) / 6]                                                                                [Stage 925:======================================>                  (4 + 2) / 6]                                                                                [Stage 1043:=====================================>                  (4 + 2) / 6]                                                                                [Stage 1177:=====================================>                  (4 + 2) / 6]                                                                                [Stage 1327:============================>                           (3 + 3) / 6][Stage 1327:==============================================>         (5 + 1) / 6]                                                                                [Stage 1409:=====================================>                  (4 + 2) / 6]                                                                                [Stage 1495:==============================================>         (5 + 1) / 6]                                                                                [Stage 1597:=====================================>                  (4 + 2) / 6]                                                                                [Stage 1715:=====================================>                  (4 + 2) / 6]                                                                                [Stage 1849:============================>                           (3 + 3) / 6]                                                                                [Stage 1999:==================>                                     (2 + 4) / 6][Stage 1999:==============================================>         (5 + 1) / 6]                                                                                [Stage 2081:=====================================>                  (4 + 2) / 6]                                                                                [Stage 2167:=====================================>                  (4 + 2) / 6]                                                                                [Stage 2269:=====================================>                  (4 + 2) / 6]                                                                                [Stage 2387:=====================================>                  (4 + 2) / 6]                                                                                [Stage 2521:==================>                                     (2 + 4) / 6]                                                                                [Stage 2671:=====================================>                  (4 + 2) / 6]                                                                                [Stage 2753:=====================================>                  (4 + 2) / 6]                                                                                [Stage 2839:=====================================>                  (4 + 2) / 6]                                                                                [Stage 2941:==============================================>         (5 + 1) / 6]                                                                                [Stage 3059:============================>                           (3 + 3) / 6][Stage 3059:==============================================>         (5 + 1) / 6]                                                                                [Stage 3193:=====================================>                  (4 + 2) / 6]                                                                                [Stage 3343:=====================================>                  (4 + 2) / 6]                                                                                [Stage 3425:>                                                       (0 + 4) / 6][Stage 3425:==================>                                     (2 + 4) / 6][Stage 3425:=====================================>                  (4 + 2) / 6]                                                                                [Stage 3511:=====================================>                  (4 + 2) / 6]                                                                                [Stage 3613:=====================================>                  (4 + 2) / 6]                                                                                [Stage 3731:=====================================>                  (4 + 2) / 6][Stage 3731:==============================================>         (5 + 1) / 6]                                                                                [Stage 3865:=====================================>                  (4 + 2) / 6]                                                                                [Stage 4015:=====================================>                  (4 + 2) / 6]                                                                                [Stage 4097:=========>                                              (1 + 4) / 6][Stage 4097:=====================================>                  (4 + 2) / 6]                                                                                [Stage 4183:=====================================>                  (4 + 2) / 6]                                                                                [Stage 4285:=====================================>                  (4 + 2) / 6]                                                                                [Stage 4403:=====================================>                  (4 + 2) / 6]                                                                                [Stage 4537:=====================================>                  (4 + 2) / 6]                                                                                [Stage 4687:============================>                           (3 + 3) / 6]                                                                                [Stage 4769:=====================================>                  (4 + 2) / 6]                                                                                [Stage 4855:==================>                                     (2 + 4) / 6]                                                                                [Stage 4957:=====================================>                  (4 + 2) / 6]                                                                                [Stage 5075:=====================================>                  (4 + 2) / 6]                                                                                [Stage 5209:=====================================>                  (4 + 2) / 6]                                                                                [Stage 5359:==================>                                     (2 + 4) / 6][Stage 5359:==============================================>         (5 + 1) / 6]                                                                                [Stage 5441:=========>                                              (1 + 4) / 6][Stage 5441:=====================================>                  (4 + 2) / 6]                                                                                [Stage 5527:=====================================>                  (4 + 2) / 6]                                                                                [Stage 5629:=====================================>                  (4 + 2) / 6]                                                                                [Stage 5747:=====================================>                  (4 + 2) / 6]                                                                                [Stage 5881:==================>                                     (2 + 4) / 6][Stage 5881:==============================================>         (5 + 1) / 6]                                                                                [Stage 6031:============================>                           (3 + 3) / 6]                                                                                [Stage 6053:=====================================>                  (4 + 2) / 6][Stage 6053:==============================================>         (5 + 1) / 6]                                                                                [Stage 6113:=====================================>                  (4 + 2) / 6]                                                                                [Stage 6199:=====================================>                  (4 + 2) / 6]                                                                                [Stage 6301:=====================================>                  (4 + 2) / 6]                                                                                Exception in thread "stdout writer for python3" java.lang.AssertionError: assertion failed: Block rdd_15_0 is not locked for reading
	at scala.Predef$.assert(Predef.scala:170)
	at org.apache.spark.storage.BlockInfoManager.unlock(BlockInfoManager.scala:299)
	at org.apache.spark.storage.BlockManager.releaseLock(BlockManager.scala:771)
	at org.apache.spark.storage.BlockManager$$anonfun$1.apply$mcV$sp(BlockManager.scala:542)
	at org.apache.spark.util.CompletionIterator$$anon$1.completion(CompletionIterator.scala:44)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:33)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$class.foreach(Iterator.scala:893)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:223)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:439)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread$$anonfun$run$1.apply(PythonRunner.scala:247)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1992)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:170)
[Stage 6553:=========>                                              (1 + 5) / 6][Stage 6553:=====================================>                  (4 + 2) / 6]                                                                                [Stage 6703:==================>                                     (2 + 4) / 6][Stage 6703:==============================================>         (5 + 1) / 6]                                                                                [Stage 6785:==================>                                     (2 + 4) / 6][Stage 6785:==============================================>         (5 + 1) / 6]                                                                                [Stage 6871:=====================================>                  (4 + 2) / 6][Stage 6871:==============================================>         (5 + 1) / 6]                                                                                [Stage 6973:=====================================>                  (4 + 2) / 6]                                                                                [Stage 7091:=====================================>                  (4 + 2) / 6]                                                                                [Stage 7225:============================>                           (3 + 3) / 6]                                                                                [Stage 7375:==================>                                     (2 + 4) / 6]                                                                                [Stage 7457:==================>                                     (2 + 4) / 6]                                                                                [Stage 7543:=====================================>                  (4 + 2) / 6]                                                                                [Stage 7645:==================>                                     (2 + 4) / 6]                                                                                [Stage 7763:=====================================>                  (4 + 2) / 6]                                                                                [Stage 7897:============================>                           (3 + 3) / 6][Stage 7897:=====================================>                  (4 + 2) / 6]                                                                                [Stage 8047:=====================================>                  (4 + 2) / 6]                                                                                [Stage 8129:=====================================>                  (4 + 2) / 6]                                                                                [Stage 8215:=====================================>                  (4 + 2) / 6]                                                                                [Stage 8317:=====================================>                  (4 + 2) / 6]                                                                                [Stage 8435:=====================================>                  (4 + 2) / 6]                                                                                [Stage 8569:============================>                           (3 + 3) / 6]                                                                                [Stage 8719:==================>                                     (2 + 4) / 6][Stage 8719:==============================================>         (5 + 1) / 6]                                                                                [Stage 8801:============================>                           (3 + 3) / 6]                                                                                [Stage 8887:=====================================>                  (4 + 2) / 6]                                                                                [Stage 8989:=====================================>                  (4 + 2) / 6]                                                                                [Stage 9107:=====================================>                  (4 + 2) / 6]                                                                                [Stage 9241:=====================================>                  (4 + 2) / 6]                                                                                [Stage 9391:=====================================>                  (4 + 2) / 6]                                                                                [Stage 9473:==============================================>         (5 + 1) / 6]                                                                                [Stage 9559:=====================================>                  (4 + 2) / 6]                                                                                [Stage 9661:=====================================>                  (4 + 2) / 6]                                                                                [Stage 9779:============================>                           (3 + 3) / 6]                                                                                [Stage 9913:=====================================>                  (4 + 2) / 6]                                                                                [Stage 10063:====================================>                  (4 + 2) / 6]                                                                                [Stage 10145:=============================================>         (5 + 1) / 6]                                                                                [Stage 10231:====================================>                  (4 + 2) / 6]                                                                                [Stage 10333:=============================================>         (5 + 1) / 6]                                                                                [Stage 10451:====================================>                  (4 + 2) / 6]                                                                                [Stage 10585:====================================>                  (4 + 2) / 6]                                                                                [Stage 10735:====================================>                  (4 + 2) / 6]                                                                                [Stage 10817:=========>                                             (1 + 4) / 6][Stage 10817:====================================>                  (4 + 2) / 6]                                                                                [Stage 10903:====================================>                  (4 + 2) / 6]                                                                                [Stage 11005:====================================>                  (4 + 2) / 6]                                                                                [Stage 11257:===========================>                           (3 + 3) / 6][Stage 11257:====================================>                  (4 + 2) / 6]                                                                                [Stage 11407:====================================>                  (4 + 2) / 6]                                                                                [Stage 11489:=========>                                             (1 + 4) / 6][Stage 11489:=============================================>         (5 + 1) / 6]                                                                                [Stage 11575:==================>                                    (2 + 4) / 6][Stage 11575:====================================>                  (4 + 2) / 6]                                                                                [Stage 11677:====================================>                  (4 + 2) / 6]                                                                                [Stage 11795:====================================>                  (4 + 2) / 6]                                                                                [Stage 11929:====================================>                  (4 + 2) / 6]                                                                                [Stage 12079:====================================>                  (4 + 2) / 6]                                                                                [Stage 12161:===========================>                           (3 + 3) / 6][Stage 12161:=============================================>         (5 + 1) / 6]                                                                                [Stage 12247:====================================>                  (4 + 2) / 6]                                                                                [Stage 12349:====================================>                  (4 + 2) / 6]                                                                                [Stage 12467:====================================>                  (4 + 2) / 6]                                                                                [Stage 12601:====================================>                  (4 + 2) / 6]                                                                                [Stage 12751:====================================>                  (4 + 2) / 6]                                                                                [Stage 12833:====================================>                  (4 + 2) / 6]                                                                                [Stage 12919:=============================================>         (5 + 1) / 6]                                                                                [Stage 13021:====================================>                  (4 + 2) / 6]                                                                                [Stage 13139:===========================>                           (3 + 3) / 6][Stage 13139:=============================================>         (5 + 1) / 6]                                                                                [Stage 13273:====================================>                  (4 + 2) / 6]                                                                                [Stage 13423:====================================>                  (4 + 2) / 6]                                                                                [Stage 13505:====================================>                  (4 + 2) / 6]                                                                                [Stage 13591:====================================>                  (4 + 2) / 6]                                                                                [Stage 13693:====================================>                  (4 + 2) / 6]                                                                                [Stage 13811:====================================>                  (4 + 2) / 6]                                                                                [Stage 13945:====================================>                  (4 + 2) / 6][Stage 13945:=============================================>         (5 + 1) / 6]                                                                                [Stage 14095:====================================>                  (4 + 2) / 6]                                                                                [Stage 14177:====================================>                  (4 + 2) / 6]                                                                                [Stage 14263:====================================>                  (4 + 2) / 6]                                                                                [Stage 14365:=============================================>         (5 + 1) / 6]                                                                                [Stage 14483:====================================>                  (4 + 2) / 6]                                                                                [Stage 14617:==================>                                    (2 + 4) / 6][Stage 14617:====================================>                  (4 + 2) / 6]                                                                                [Stage 14767:====================================>                  (4 + 2) / 6]                                                                                [Stage 14935:====================================>                  (4 + 2) / 6]                                                                                [Stage 15037:====================================>                  (4 + 2) / 6]                                                                                [Stage 15289:====================================>                  (4 + 2) / 6]                                                                                [Stage 15439:====================================>                  (4 + 2) / 6]                                                                                Exception in thread "serve RDD 18556 with partitions 0" java.net.SocketTimeoutException: Read timed out
/usr/local/lib/python3.6/dist-packages/matplotlib/figure.py:448: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  % get_backend())
	at java.net.SocketInputStream.socketRead0(Native Method)
	at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)
	at java.net.SocketInputStream.read(SocketInputStream.java:171)
	at java.net.SocketInputStream.read(SocketInputStream.java:141)
	at java.net.SocketInputStream.read(SocketInputStream.java:224)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.spark.security.SocketAuthHelper.readUtf8(SocketAuthHelper.scala:87)
	at org.apache.spark.security.SocketAuthHelper.authClient(SocketAuthHelper.scala:55)
	at org.apache.spark.api.python.PythonServer$$anon$1.run(PythonRDD.scala:839)
>>> Traceback (most recent call last):
  File "/opt/spark/python/pyspark/shell.py", line 88, in <module>
    exec(code)
  File "movielens.py", line 129, in <module>
    _test, _train = run_training(rank,iteration)
  File "movielens.py", line 90, in run_training
    pred_train = model.predictAll(pred_train_input) 
  File "/opt/spark/python/pyspark/mllib/recommendation.py", line 145, in predictAll
    first = user_product.first()
  File "/opt/spark/python/pyspark/rdd.py", line 1376, in first
    rs = self.take(1)
  File "/opt/spark/python/pyspark/rdd.py", line 1358, in take
    res = self.context.runJob(self, takeUpToNumLeft, p)
  File "/opt/spark/python/pyspark/context.py", line 1034, in runJob
    return list(_load_from_socket(sock_info, mappedRDD._jrdd_deserializer))
  File "/opt/spark/python/pyspark/rdd.py", line 142, in _load_from_socket
    (sockfile, sock) = local_connect_and_auth(*sock_info)
  File "/opt/spark/python/pyspark/java_gateway.py", line 169, in local_connect_and_auth
    _do_server_auth(sockfile, auth_secret)
  File "/opt/spark/python/pyspark/java_gateway.py", line 144, in _do_server_auth
    reply = UTF8Deserializer().loads(conn)
  File "/opt/spark/python/pyspark/serializers.py", line 653, in loads
    length = read_int(stream)
  File "/opt/spark/python/pyspark/serializers.py", line 692, in read_int
    raise EOFError
EOFError
